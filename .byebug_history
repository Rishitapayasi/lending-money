c
n
loan_request.user.wallet_balance >= loan_request.total_amount
loan_request.total_amount
loan_request.user.wallet_balance 
loan_request
c
params['loan_request']['amount']
params['loan_request']
params[loan_request]
params
amount
params[:loan_request][amount]
params[amount]
params[loan_request]
params[loan_request][amount]
params[:loan_request][amount]
params
pay_amount
amount
params[:amount]
c
response = FCM_CLIENT.send([user.fcm_token], options)
FCM_CLIENT.send(options)
user.fcm_token
FCM_CLIENT
n
body
 title
user
c
response = FCM_CLIENT.send([user.fcm_token], options)
FCM_CLIENT
n
body
title
user
c
@loan_request
c
n
current_user.loan_requests.new(loan_request_params)
loan_request_params
n
@loan_request = LoanRequest.new
current_user@loan_request = LoanRequest.new
@loan_request
current_user
c
@loan_request
loan_request_params
current_user.loan_requests.new
loan_request_params
current_user
c
user_wallet = user_wallet + @loan_request.amount
current_user.wallet_balance = current_user.wallet_balance - @loan_request.amount
user_wallet = @loan_request.user.wallet_balance
user_wallet
c
update_wallet_balance
n
@loan_request.state
@loan_request.state = 'approved'
@loan_request.state
c
n
current_user.is_admin
c
n
current_user.is_admin
c
n
response_body || response.committed?
n
c
wallet_balance = is_admin ? 100000 : 10000
is_admin
